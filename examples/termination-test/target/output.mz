main(n) := f0(0u64, 0u64, n);

f0(v0, v1, v2) :=
    match =(v1, v2) {
    F() -> f1(v0, v2, +(v1, 1u64)),
    T() -> f1(+(v0, 1u64), v2, v2)
    };

f1(v0, v1, v2) := f0(v0, v2, v1);
